define(["jquery","core/ajax","core/log"],function(a,b,c){const d={required:function(a){return a.value.length>0},email:function(a){var b=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;return b.test(a.value)},tel:function(a){var b=/^[+]*[(]{0,1}[0-9]{1,3}[)]{0,1}[-\s\./0-9]*$/;return b.test(a.value)},validate:function(a){if(a.required)return"function"==typeof d[a.type]?d[a.type](a):d.required(a)}};var e={forms:["getstartedform","accountform","accounttypeform","usertypeform"],validator:d,usertype:[],init:function(a){1==a?e.forms=["getstartedform","thanksform"]:(e.initFormValidation("accountform"),e.initFormValidation("accounttypeform"),e.initAccountTypeSelection(),e.initUserTypeSelection(),e.setupSubmitAction()),e.initNextAction(),e.initPrevAction()},getPrevForm:function(a){var b=e.forms.indexOf(a),c=e.forms[b-1];return!!c.length&&c},getNextForm:function(a){var b=e.forms.indexOf(a),c=e.forms[b+1];return!!c.length&&c},toggleForms:function(a,b){document.getElementById(b).classList.add("intelliboard-hide"),document.getElementById(a).classList.remove("intelliboard-hide")},getFormInputs:function(a){var b=document.getElementById(a);return b.querySelectorAll("input, select")},setValidationState:function(a,b){b?(a.classList.remove("is-invalid"),a.classList.add("is-valid")):(a.classList.remove("is-valid"),a.classList.add("is-invalid"))},initValidationAction:function(a){a.forEach(function(a){if(a.required){var b="input";"select"===a.type&&(b="change"),a.addEventListener(b,function(){e.setValidationState(a,e.validator.validate(a))})}})},setHelpTextState:function(a,b){var c=document.getElementById(a).getElementsByClassName("form-help-text")[0];c&&(b?c.classList.replace("invisible","visible"):c.classList.replace("visible","invisible"))},setNextButtonState:function(a,b){var c=document.getElementById(a).getElementsByClassName("next-btn")[0];c&&(c.disabled=b,e.setHelpTextState(a,b))},isFormValid:function(a){for(var b=e.getFormInputs(a),c=0;c<b.length;c++)if(b[c].required&&!e.validator.validate(b[c]))return!1;return!0},initFormValidation:function(a){var b=e.getFormInputs(a);e.initValidationAction(b);for(var c=0;c<b.length;c++){var d="input";"select"===b[c].type&&(d="change"),b[c].addEventListener(d,function(b){e.setNextButtonState(a,!e.isFormValid(a))})}},initNextAction:function(){Array.from(document.getElementsByClassName("next-btn")).forEach(function(a){a.addEventListener("click",function(a){var b=a.currentTarget.getAttribute("data-form"),c=e.getNextForm(b);e.toggleForms(c,b);var d=e.getFormInputs(c);return d[0]&&d[0].dispatchEvent(new Event("input")),!1},!1)})},initPrevAction:function(){Array.from(document.getElementsByClassName("prev-btn")).forEach(function(a){a.addEventListener("click",function(a){var b=a.currentTarget.getAttribute("data-form"),c=e.getPrevForm(b);return e.toggleForms(c,b),!1},!1)})},initAccountTypeSelection:function(){for(var a=document.getElementsByClassName("accounttype"),b=0;b<a.length;b++)a[b].addEventListener("click",function(b){Array.from(a).forEach(function(a){a.classList.remove("active"),a.setAttribute("aria-pressed","false")}),b.currentTarget.classList.add("active"),b.currentTarget.setAttribute("aria-pressed","true");var c=b.currentTarget.getAttribute("data-accounttype"),d=document.getElementById("accounttype");return d.value!=c&&e.setupUserTypeForm(c),d.value=c,d.dispatchEvent(new Event("input")),!1},!1)},setupUserTypeForm:function(a){e.usertype=[],Array.from(document.getElementsByClassName("usertype")).forEach(function(a){a.classList.remove("active"),a.setAttribute("aria-pressed","false")}),document.getElementById("submitdata").disabled=!0,Array.from(document.getElementsByClassName("intelliboard-user-types")).forEach(function(b){b.id===a?b.classList.remove("intelliboard-hide"):b.classList.add("intelliboard-hide")})},initUserTypeSelection:function(){for(var a=document.getElementsByClassName("usertype"),b=0;b<a.length;b++)a[b].addEventListener("click",function(a){var b=a.currentTarget,c=b.getAttribute("data-usertype");e.usertype.indexOf(c)>=0?(e.usertype.splice(e.usertype.indexOf(c),1),b.classList.remove("active"),b.setAttribute("aria-pressed","false")):(e.usertype.push(c),b.classList.add("active"),b.setAttribute("aria-pressed","true"));var d=e.usertype.length>0;return document.getElementById("submitdata").disabled=!d,e.setHelpTextState("usertypeform",!d),!1},!1)},setupSubmitAction:function(){var a=document.getElementById("submitdata");a.addEventListener("click",function(a){var b=document.getElementsByClassName("intelliboard-splash-page"),c={};c.usertype=e.usertype.toString(),Array.from(b).forEach(function(a){a.querySelectorAll("input, select").forEach(function(a){c[a.name]=a.value}),"thanksform"===a.id?a.classList.remove("intelliboard-hide"):a.classList.add("intelliboard-hide")}),e.sendData(c)},!1)},sendData:function(a){b.call([{methodname:"local_intelliboard_account_setup",args:{params:a}}])}};return e});